# 案例2：肺炎影像学诊断

## 1 问题描述

肺炎是指由细菌、病毒等病原体引起的，在肺泡、远端气道和肺间质的感染性炎症，常伴有咳嗽、咳痰、呼吸困难等症状。由于肺炎的轻微体征和症状通常与感冒或流感相似，且上呼吸道感染容易转化成肺炎，因此，及时发现肺炎对于病情的治疗、病理研究乃至大规模公共卫生事件的预防都具有重要的意义。目前，很多肺炎病情可以通过肺部计算机断层成像（CT）或胸部X 光影像发现，也可借助这一手段明确肺炎病变位置、严重程度，观察治疗是否有效，监测病情恢复程度等。正常胸部X 光图像中没有任何异常的不透明区域。细菌性肺炎通常表现出焦点叶巩固，而病毒性肺炎表现为在两个肺中具有更弥漫的“间膜”模式。因此，通过机器学习方法帮助医生快速检查大量X 光图像，提高影像学检查准确率，减少医生负担，不仅是切实可行的技术手段，更是迫切的医学需求。本例中，我们将利用卷积神经网络（CNN）方法对5000 多张带标签的肺部影像图片进行学习，建立肺炎影像学诊断智能模型，为新病例的快速筛查和临床诊断提供辅助手段



## 2 学习方法

本例介绍的肺炎影响诊断问题是一个典型的图像二分类问题，我们以标准化后的肺炎 X光图像为输入，以图像的分类标签  (1,0)（正常）和(0,1)（肺炎）为输出，通过卷积神经网络（CNN）建立肺炎诊断模型，并利用学得的模型对新的病例进行判断，检测是否被感染。



## 3 数据准备

本例使用的数据集来自  Kaggle（https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia）， 其中收集的胸部X 光图像是从广州市妇女儿童医疗中心一至五岁儿科患者的回顾组中挑选的。数据集被分成 3 个文件夹（train、val、test），每个文件夹内的图像被分为肺炎和正常两类并存储于相应的子文件夹中。本例仅使用train 和val 两个文件夹中的X 光图像进行模型训练和测试。其中，train 文件夹内共有5210 张图像，包含正常图像1340 个，肺炎图像3870 个，用作训练集和验证集；val 文件夹内共有521 张图像，包含正常图像134 个，肺炎图像387 个，用作测试集。图6 给出了训练和验证集中的部分胸部肺炎X光图像样本示意图。